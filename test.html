<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button { padding: 10px 20px; font-size: 16px; }
        </style>
</head>
<body>
      
      <button id="generar-pdf">Generar PDF</button>
      
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
      <script>
            $('#generar-pdf').click(async function () {
                  const { jsPDF } = window.jspdf;
                  const doc = new jsPDF();

                  // Cargar la imagen que subiste (convertirla en base64 si está en local)
                  const fondoBase64 = await toBase64('img/Imagen2.png');

                  // Tabla de ejemplo similar a la tuya
                  const head = [['TRABAJO REALIZADO', 'FECHA DE MMTO.', 'MEDICIONES']];
                  const body = [
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca York en área 1er Piso (Limpieza de tapas, charolas, filtros, conchas y serpentín)",	"01 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca York en área 1er Piso (Limpieza de tapas, charolas, filtros, conchas y serpentín)",	"01 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Casette marca York en área 1er Piso (Limpieza de tapas, charolas, filtros, conchas y serpentín)",	"01 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Casette marca York en área 1er Piso (Limpieza de tapas, charolas, filtros, conchas y serpentín)",	"01 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Casette marca York en área 1er Piso (Limpieza de tapas, charolas, filtros, conchas y serpentín)",	"01 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos instalación a un equipo Fan & Coil marca Daikin (Instalación de bomba genérica provisional)",	"02 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit (Limpieza de tapas, serpentín, filtro, charola, turbina, aletas de ventilación, bomba, flotador y conchas)",	"03 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil (Limpieza de tapas, serpentín, filtro, charola, turbina, aletas de ventilación, bomba, flotador y conchas)",	"03 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil (Limpieza de tapas, serpentín, filtro, charola, turbina, aletas de ventilación, bomba, flotador y conchas)",	"03 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Casette (Limpieza de tapas, serpentín, filtro, charola, turbina, aletas de ventilación, bomba, flotador y conchas)",	"03 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca York (Limpieza de turbina, carcaza, filtro, charola, serpentin, bomba, flotador, tapas, interior y exterior)",	"04 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca York (Limpieza de turbina, carcaza, filtro, charola, serpentin, bomba, flotador, tapas, interior y exterior)",	"04 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca York (Limpieza de turbina, carcaza, filtro, charola, serpentin, bomba, flotador, tapas, interior y exterior)",	"04 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca York (Limpieza de turbina, carcaza, filtro, charola, serpentin, bomba, flotador, tapas, interior y exterior)",	"04 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca York (Limpieza de turbina, carcaza, filtro, charola, serpentin, bomba, flotador, tapas, interior y exterior)",	"04 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca York (Limpieza de turbina, carcaza, filtro, charola, serpentin, bomba, flotador, tapas, interior y exterior)",	"04 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca York (Limpieza de turbina, carcaza, filtro, charola, serpentin, bomba, flotador, tapas, interior y exterior)",	"04 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit (Limpieza de turbina, charola, serpentín, evaporador, bomba, flotador, ventilas, filtro y tapas)",	"10 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit (Limpieza de turbina, charola, serpentín, evaporador, bomba, flotador, ventilas, filtro y tapas)",	"10 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil (Limpieza de turbina, charola, serpentín, evaporador, bomba, flotador, ventilas, filtro y tapas)",	"10 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Casette (Limpieza de turbina, charola, serpentín, evaporador, bomba, flotador, ventilas, filtro y tapas)",	"10 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Casette marca Daikin (Limpieza de tapas, turbina, charola, conchas, bomba y flotador, serpentin y filtro de aire)",	"12 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo VRV marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo VRV marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo VRV marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo VRV marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo VRV marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo VRV marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo VRV marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo VRV marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo VRV marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo VRV marca Daikin (Limpieza de tapas y serpentin condensador; se revisan parámetros de operación)",	"22 ABR",	
`Voltaje 220V
Refrig. R-410
PSI Al 350-370 Ba 115-125
Amperaje 13-15`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit (Limpieza de carcaza, serpentin, turbina, charola y filtros)",	"30 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit (Limpieza de carcaza, serpentin, turbina, charola y filtros)",	"30 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit (Limpieza de carcaza, serpentin, turbina, charola y filtros)",	"30 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit (Limpieza de carcaza, serpentin, turbina, charola y filtros)",	"30 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Minisplit (Limpieza de carcaza, serpentin, turbina, charola y filtros)",	"30 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Fan & Coil (Limpieza de carcaza, serpentin, turbina, charola y filtros)",	"30 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Cond. de Minisplit (Limpieza de carcaza, serpentin, turbina, charola y filtros)",	"30 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Cond. de Minisplit (Limpieza de carcaza, serpentin, turbina, charola y filtros)",	"30 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Cond. de Minisplit (Limpieza de carcaza, serpentin, turbina, charola y filtros)",	"30 ABR",	
`Voltaje 220V
Refrig. R-410`],
      ["Realizamos mantenimiento preventivo a un equipo Cond. de Minisplit (Limpieza de carcaza, serpentin, turbina, charola y filtros)",	"30 ABR",	
`Voltaje 220V
Refrig. R-410`]
      ];

      const pageWidth = doc.internal.pageSize.getWidth();
      const availableWidth = pageWidth - 15 - 15; // margen izquierdo y derecho

      // Ejemplo: 70% para la primera columna, 15% y 15% para las otras
      const col1Width = availableWidth * 0.6;
      const col2Width = availableWidth * 0.2;
      const col3Width = availableWidth * 0.2;

      doc.autoTable({
        head: [['TRABAJO REALIZADO', 'FECHA DE MMTO.', 'MEDICIONES']],
        body: body, // Aquí asegúrate de que tu body ya venga con texto enriquecido si lo necesitas
        headStyles: {
            fillColor: [0, 51, 102],
            textColor: 255,
            fontStyle: 'bold',
            fontSize: 13,
            halign: 'center',
            valign: 'middle',
            lineWidth: 0.2,
            lineColor: [0, 0, 0],
            font: 'helvetica'
        },
        bodyStyles: {
            textColor: [33, 37, 41],
            fontSize: 11,
            valign: 'top',
            cellPadding: 2,
            lineWidth: 0.2,
            lineColor: [0, 0, 0],
            font: 'helvetica'
        },
        didParseCell: function (data) {
            if (data.section === 'body') {
                const rowIndex = data.row.index; // 0-based index

                // Por ejemplo: filas pares (0, 2, 4...) = color A
                if (rowIndex % 2 === 0) {
                    data.cell.styles.fillColor = [218, 236, 255];  // azul claro (como tienes)
                }
                // Filas impares (1, 3, 5...) = color B
                else {
                    data.cell.styles.fillColor = [230, 247, 255];  // azul más fuerte (el que pediste)
                }
            }
        },
        margin: { top: 60, left: 15, right: 15, bottom: 60 },
        columnStyles: {
            0: { cellWidth: col1Width, halign: 'left', valign: 'top' },  // trabajo realizado
            1: { cellWidth: col2Width, halign: 'center', valign: 'middle' },  // fecha
            2: { cellWidth: col3Width, halign: 'left', valign: 'top' }   // mediciones
        },
        didDrawPage: function (data) {
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();

            // Dibujar fondo
            doc.addImage(fondoBase64, 'PNG', 0, 0, pageWidth, pageHeight);

            // Pie de página
            doc.setFontSize(10);
            doc.setTextColor(200);
            doc.text('Página ' + doc.internal.getNumberOfPages(), pageWidth - 20, pageHeight - 10);
        }
      });

      doc.save('reporte_mantenimiento.pdf');

      // Helper para convertir imagen a base64
      async function toBase64(url) {
        const response = await fetch(url);
        const blob = await response.blob();
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onloadend = () => resolve(reader.result);
          reader.onerror = reject;
          reader.readAsDataURL(blob);
        });
      }
    });
  </script>

</body>
</html>
